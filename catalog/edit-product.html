<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title data-i18n="page_title">Product Editor</title>
  
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="../styles.css">
  
  <style>
    /* Provider Cards Styles */
    .providers-section {
      margin-top: 20px;
    }
    
    .providers-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 12px;
    }
    
    .provider-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-radius: 12px;
      padding: 16px;
      color: white;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.2s;
    }
    
    .provider-card:active {
      transform: scale(0.98);
    }
    
    .provider-card.internal {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }
    
    .provider-card.external {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }
    
    .provider-card.empty {
      background: #f0f0f0;
      color: #666;
    }
    
    .provider-avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
    }
    
    .provider-info {
      flex: 1;
      min-width: 0;
    }
    
    .provider-name {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .provider-meta {
      font-size: 12px;
      opacity: 0.9;
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }
    
    .provider-badge {
      background: rgba(255,255,255,0.25);
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 10px;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    
    .skills-display {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    
    .skill-badge {
      background: var(--gradient-primary);
      color: white;
      padding: 6px 12px;
      border-radius: 16px;
      font-size: 12px;
      font-weight: 500;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .provider-hint {
      font-size: 13px;
      color: #666;
      margin-top: 8px;
      padding-left: 4px;
    }
  </style>
</head>
<body>

  <!-- LOADING OVERLAY -->
  <div id="loader">
    <div class="spinner-ring"></div>
    <div id="loaderText" data-i18n="loading">Caricamento...</div>
  </div>

  <div class="container hidden fade-in" id="app-content">
    <h1 id="pageTitle" data-i18n="title">‚úèÔ∏è Modifica Prodotto</h1>
    <p class="subtitle" id="pageSubtitle" data-i18n="subtitle">Gestione dettagli e prezzi</p>
    
    <form id="productForm">
      
      <!-- IDENTIT√Ä -->
      <div class="form-section">
        <div class="form-section-title" data-i18n="secIdentity">üìã Identit√†</div>
        
        <div class="form-group">
          <label for="itemName" class="required" data-i18n="lblName">Nome Prodotto</label>
          <input type="text" id="itemName" required placeholder="...">
        </div>

        <div class="row">
          <div class="col">
            <div class="form-group">
              <label>SKU</label>
              <input type="text" id="itemSku" disabled style="opacity: 0.7;">
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <label for="itemType" data-i18n="lblType">Tipo</label>
              <select id="itemType">
                <option value="SERVICE" data-i18n="optService">Servizio</option>
                <option value="PRODUCT" data-i18n="optProduct">Prodotto</option>
              </select>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="descShort" class="required" data-i18n="lblShort">Descrizione Breve</label>
          <input type="text" id="descShort" maxlength="100" required>
        </div>

        <div class="form-group">
          <label for="descLong" data-i18n="lblLong">Descrizione Completa</label>
          <textarea id="descLong" rows="4"></textarea>
        </div>

        <div class="form-group">
          <label for="internalNotes" data-i18n="lblInternal">Note Interne</label>
          <textarea id="internalNotes" rows="2" class="monospace"></textarea>
        </div>
      </div>

      <!-- PRICING -->
      <div class="form-section">
        <div class="form-section-title" data-i18n="secPricing">üí∞ Pricing</div>
        <div class="row">
          <div class="col">
            <div class="form-group">
              <label for="basePrice" class="required" data-i18n="lblPrice">Prezzo Base</label>
              <input type="number" id="basePrice" step="0.01" min="0" required>
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <label for="currency" data-i18n="lblCurrency">Valuta</label>
              <select id="currency">
                <option value="EUR">EUR (‚Ç¨)</option>
                <option value="USD">USD ($)</option>
              </select>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="form-group">
              <label for="unitOfMeasure" class="required" data-i18n="lblUnit">Unit√†</label>
              <select id="unitOfMeasure" required>
                <option value="item" data-i18n="optItem">Pezzo</option>
                <option value="hour" data-i18n="optHour">Ora</option>
                <option value="day" data-i18n="optDay">Giorno</option>
                <option value="project" data-i18n="optProject">Progetto</option>
                <option value="month" data-i18n="optMonth">Mese</option>
              </select>
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <label for="taxRate" data-i18n="lblTax">IVA (%)</label>
              <input type="number" id="taxRate" step="1" min="0" max="100" value="22">
            </div>
          </div>
        </div>
      </div>

      <!-- OPERATIONS & TAGS -->
      <div class="form-section">
        <div class="form-section-title" data-i18n="secOps">‚öôÔ∏è Operativit√†</div>
        <div class="checkbox-group">
          <input type="checkbox" id="requiresBooking"><label for="requiresBooking" data-i18n="chkBooking">Prenotazione</label>
          <input type="checkbox" id="requiresInventory"><label for="requiresInventory" data-i18n="chkInventory">Inventario</label>
        </div>

        <div class="form-group">
          <label for="skillTagInput" data-i18n="lblSkills">Skill Richieste</label>
          <div class="tag-input-container" id="skillTagsContainer">
            <input type="text" id="skillTagInput" placeholder="...">
          </div>
        </div>

        <div class="form-group">
          <label for="keywordInput" data-i18n="lblKeywords">Keywords (SEO)</label>
          <div class="tag-input-container" id="keywordsContainer">
            <input type="text" id="keywordInput" placeholder="...">
          </div>
        </div>
      </div>

      <!-- üÜï PROVIDER SECTION -->
      <div class="form-section providers-section">
        <div class="form-section-title">üë§ Erogatori / Fornitori</div>
        
        <div class="form-group">
          <label>Competenze Richieste</label>
          <div id="skills-display" class="skills-display">
            <!-- Populated by JS -->
          </div>
        </div>
        
        <div class="form-group">
          <label>Provider Specifici</label>
          <div id="providers-display" class="providers-list">
            <!-- Populated by JS -->
          </div>
          <p class="provider-hint">
            üí° Se vuoto, qualsiasi provider con le skill richieste pu√≤ erogare il servizio
          </p>
        </div>
      </div>

      <!-- Spacing for FAB -->
      <div style="height: 80px;"></div>
    </form>
  </div>

  <!-- FAB CONTAINER -->
  <div class="fab-container">
    <button class="fab-btn fab-secondary" onclick="goBackToCatalog()" title="Torna al Catalogo">
      <i class="fas fa-arrow-left"></i>
    </button>
    
    <button class="fab-btn" id="saveBtn" title="Salva Modifiche">
      <i class="fas fa-save"></i>
    </button>
  </div>

  <script src="edit-product_logic.js"></script>
</body>
</html>